<html xmlns:NetUtils="org.apache.cocoon.util.NetUtils">
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>cTwIG - Cocoon Two Idiots Guide - Basic XSP Processing</title>
<script type="text/javascript" src="resources/script.js" language="JavaScript"></script>
</head>
<body bgcolor="#ffffff" marginheight="4" marginwidth="4" leftmargin="4" topmargin="4" alink="#cc0000" vlink="#0086b2" link="#039acc" text="#000000">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" rowspan="3" height="60" width="135"><img border="0" vspace="0" hspace="0" src="images/logo.gif" height="60" width="135"></td><td background="images/line.gif" colspan="2" align="left" valign="top" height="5" width="100%"><img align="left" border="0" vspace="0" hspace="0" src="images/line.gif" height="5" width="1"></td><td align="left" valign="top" rowspan="3" height="60" width="29"><img border="0" vspace="0" hspace="0" src="images/right.gif" height="60" width="29"></td>
</tr>
<tr>
<td bgcolor="#0086b2" colspan="2" align="right" valign="top" height="35" width="100%"><img align="right" alt="cTwIG - Cocoon Two Idiots Guide - Basic XSP Processing" border="0" vspace="0" hspace="0" src="graphics/ctwig-basic02-header.jpg_label=cTwIG%20-%20Cocoon%20Two%20Idiots%20Guide%20-%20Basic%20XSP%20Processing.jpg"></td>
</tr>
<tr>
<td background="images/bottom.gif" bgcolor="#0086b2" align="left" valign="top" height="20" width="100%"><img align="left" border="0" vspace="0" hspace="0" src="images/bottom.gif" height="20" width="3"></td><td background="images/bottom.gif" width="288" valign="top" height="20" bgcolor="#0086b2" align="right">
<table width="288" cellspacing="0" cellpadding="0" border="0">
<tr>
<td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('xml');" onMouseOut="rolloverOff('xml');" target="new" href="http://xml.apache.org/"><img onLoad="rolloverLoad('xml', 'images/button-xml-hi.gif', 'images/button-xml-lo.gif');" border="0" vspace="0" hspace="0" name="xml" src="images/button-xml-lo.gif" height="20" width="96" alt="http://xml.apache.org/"></a></td><td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('asf');" onMouseOut="rolloverOff('asf');" target="new" href="http://www.apache.org/"><img onLoad="rolloverLoad('asf', 'images/button-asf-hi.gif', 'images/button-asf-lo.gif');" border="0" vspace="0" hspace="0" name="asf" src="images/button-asf-lo.gif" height="20" width="96" alt="http://www.apache.org/"></a></td><td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('w3c');" onMouseOut="rolloverOff('w3c');" target="new" href="http://www.w3.org/"><img onLoad="rolloverLoad('w3c', 'images/button-w3c-hi.gif', 'images/button-w3c-lo.gif');" border="0" vspace="0" hspace="0" name="w3c" src="images/button-w3c-lo.gif" height="20" width="96" alt="http://www.w3.org/"></a></td>
</tr>
</table>
</td>
</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr width="100%">
<td valign="top" width="120">
<table width="120" cellspacing="0" cellpadding="0" border="0">
<tr>
<td valign="top" align="left"><img width="120" vspace="0" src="images/join.gif" hspace="0" height="14" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Main')" onMouseOut="rolloverOff('Main')" href="../index.html"><img onLoad="rolloverLoad('Main', 'graphics/Main-label_over.jpg', 'graphics/Main-label.jpg');" vspace="0" hspace="0" name="Main" width="120" height="12" border="0" src="graphics/Main-label.jpg" alt="Main"></a></td>
</tr>
<tr>
<td valign="top" align="left"><img alt="cTwIG" width="120" vspace="0" src="graphics/cTwIG-separator.jpg" hspace="0" height="20" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Home')" onMouseOut="rolloverOff('Home')" href="index.html"><img onLoad="rolloverLoad('Home', 'graphics/Home-label_over.jpg', 'graphics/Home-label.jpg');" vspace="0" hspace="0" name="Home" width="120" height="12" border="0" src="graphics/Home-label.jpg" alt="Home"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Why')" onMouseOut="rolloverOff('Why')" href="ctwig-why.html"><img onLoad="rolloverLoad('Why', 'graphics/Why-label_over.jpg', 'graphics/Why-label.jpg');" vspace="0" hspace="0" name="Why" width="120" height="12" border="0" src="graphics/Why-label.jpg" alt="Why"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Getting Started')" onMouseOut="rolloverOff('Getting Started')" href="ctwig-gettingstarted.html"><img onLoad="rolloverLoad('Getting Started', 'graphics/Getting%20Started-label_over.jpg', 'graphics/Getting%20Started-label.jpg');" vspace="0" hspace="0" name="Getting Started" width="120" height="12" border="0" src="graphics/Getting%20Started-label.jpg" alt="Getting Started"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Installing')" onMouseOut="rolloverOff('Installing')" href="ctwig-installing.html"><img onLoad="rolloverLoad('Installing', 'graphics/Installing-label_over.jpg', 'graphics/Installing-label.jpg');" vspace="0" hspace="0" name="Installing" width="120" height="12" border="0" src="graphics/Installing-label.jpg" alt="Installing"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Transformations')" onMouseOut="rolloverOff('Transformations')" href="ctwig-transformations.html"><img onLoad="rolloverLoad('Transformations', 'graphics/Transformations-label_over.jpg', 'graphics/Transformations-label.jpg');" vspace="0" hspace="0" name="Transformations" width="120" height="12" border="0" src="graphics/Transformations-label.jpg" alt="Transformations"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Resources')" onMouseOut="rolloverOff('Resources')" href="ctwig-resources.html"><img onLoad="rolloverLoad('Resources', 'graphics/Resources-label_over.jpg', 'graphics/Resources-label.jpg');" vspace="0" hspace="0" name="Resources" width="120" height="12" border="0" src="graphics/Resources-label.jpg" alt="Resources"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Contributing')" onMouseOut="rolloverOff('Contributing')" href="ctwig-contributing.html"><img onLoad="rolloverLoad('Contributing', 'graphics/Contributing-label_over.jpg', 'graphics/Contributing-label.jpg');" vspace="0" hspace="0" name="Contributing" width="120" height="12" border="0" src="graphics/Contributing-label.jpg" alt="Contributing"></a></td>
</tr>
<tr>
<td align="left" valign="top"><img width="120" vspace="0" src="images/close.gif" hspace="0" height="14" border="0"><br>
</td>
</tr>
</table>
</td><td>
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td height="10" width="100%"></td>
</tr>
<tr>
<td>
	

	
		
<div align="right">
<table cellpadding="0" cellspacing="0" width="98%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif" size="+1"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Transformations</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="98%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
			
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Basic XSP Processing</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
				
<p align="justify">XSP allows you to incorporate logic into the XML file thus providing capabilities analogous to ASP, JSP, CFM, PHP etc.  The advantage is that the logic is not tied to the rendering since a stylesheet is separately applied.  The results of the code are wrapped up in a tag which is what can be referenced in the stylesheet.</p>
				
<p align="justify">Take the following XML file (<a target="_blank" href="sample/transformations/basic02/basic02-01.xml.txt">basic02-01.xml</a>):</p>
				
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
  &lt;?xml version="1.0"?&gt;
  &lt;xsp:page 
	  xmlns:xsp="http://apache.org/xsp"
  &gt;

    &lt;page&gt;
      &lt;xsp:logic&gt;
        String msg = "Hello world!";
      &lt;/xsp:logic&gt;

      &lt;title&gt;
        Basic XSP Processing Example - BASIC02-01.XML
    	&lt;/title&gt;

      &lt;greeting&gt;
        &lt;xsp:expr&gt;msg&lt;/xsp:expr&gt;
      &lt;/greeting&gt;
    &lt;/page&gt;
  &lt;/xsp:page&gt;</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
				
<p align="justify">We have now wrapped the previous file up with an xsp:page tag and added some logic that assigns "Hello World" to a string and uses the xsp:expr tag to insert that in place of the previous text in the greeting tag.   <i>Please note that this example uses "http://apache.org/xsp" as the namespace.  This is different to older C1 based examples and should be used instead.  If you do not then this examples may not work and any logicsheet example definitely will not work.</i>
</p>
				
<p align="justify">To render this we need to tell Cocoon that this file is an XSP file.  This is easier if we either name the file as .xsp and/or put it in an XSP folder.  For now just put it in {TOMCAT_HOME}\webapps\cocoon\ctwig\xsp, keeping the .xml extension.  You can now add the following to the sitemap.xmap file:</p>
				
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
  &lt;map:match pattern="ctwig/xsp/*"&gt; 
    &lt;map:generate type="serverpages" src="ctwig/xsp/{1}"/&gt; 
    &lt;map:transform type="xslt" src="ctwig/basic01-01.xsl"/&gt; 
    &lt;map:serialize/&gt; 
  &lt;/map:match&gt;</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
				
<p align="justify">What this does is to force any file in the ctwig/xsp folder to be processed using the "serverpages" (XSP) generator, then rendered with the same XSL stylesheet as in the Basic01 example.  Note that we are telling C2 that the stylesheet is in the ctwig folder.</p>
				
<p align="justify">You can test this code by calling <a target="_blank" href="http://localhost:8080/cocoon/ctwig/xsp/basic02-01.xml">http://localhost:8080/cocoon/ctwig/xsp/basic02-01.xml</a>
</p>
				
<p align="justify">The one downside with this approach is that you can end up with XML files that contain lots of logic along with the rest of the data.  This becomes as confusing to read as when the logic is mixed with the presentation so does not really solve all the issues that are inherent to the ASP/JSP type approach.  The solution is to use <a href="ctwig-basic03.html">logicsheets</a>.</p>
			
</font></td>
</tr>
</table>
</div>
<br>
		
</font></td>
</tr>
</table>
</div>
<br>
	

</td>
</tr>
</table>
</td>
</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td bgcolor="#0086b2"><img width="1" src="images/dot.gif" height="1"></td>
</tr>
<tr>
<td align="center"><font size="-1" face="arial,helvetica,sanserif" color="#0086b2"><i>Copyright &copy; 1999-2002 The Apache Software Foundation. All Rights Reserved.</i></font></td>
</tr>
</table>
</body>
</html>
