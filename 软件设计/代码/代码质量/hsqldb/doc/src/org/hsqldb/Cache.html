<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Mon Apr 02 13:25:35 EDT 2001 -->
<TITLE>
: Class  Cache
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT ID="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT ID="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT ID="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../org/hsqldb/ByteArray.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../org/hsqldb/CacheFree.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Cache.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.hsqldb</FONT>
<BR>
Class  Cache</H2>
<PRE>
java.lang.Object
  |
  +--<B>org.hsqldb.Cache</B>
</PRE>
<HR>
<DL>
<DT> class <B>Cache</B><DT>extends java.lang.Object</DL>

<P>
Cache class declaration
 <P>The cache class implements the handling of cached tables.
<P>
<DL>
<DT><B>See Also: </B><DD><A HREF="../../org/hsqldb/Row.html"><CODE>Row</CODE></A>, 
<A HREF="../../org/hsqldb/CacheFree.html"><CODE>CacheFree</CODE></A></DL>
<HR>

<P>
<!-- ======== INNER CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private)</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#Cache(java.lang.String)">Cache</A></B>(java.lang.String&nbsp;name)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Cache constructor declaration
 </TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#add(org.hsqldb.Row)">add</A></B>(<A HREF="../../org/hsqldb/Row.html">Row</A>&nbsp;r)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add method declaration
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#cleanUp()">cleanUp</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cleanUp method declaration
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#flush()">flush</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flush method declaration
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#free(org.hsqldb.Row, int, int)">free</A></B>(<A HREF="../../org/hsqldb/Row.html">Row</A>&nbsp;r,
     int&nbsp;pos,
     int&nbsp;length)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free method declaration
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;<A HREF="../../org/hsqldb/Row.html">Row</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#getRow(int, org.hsqldb.Table)">getRow</A></B>(int&nbsp;pos,
       <A HREF="../../org/hsqldb/Table.html">Table</A>&nbsp;t)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getRow method declaration
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#open(boolean)">open</A></B>(boolean&nbsp;readonly)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;open method declaration
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>(package private) &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../org/hsqldb/Cache.html#shutdown()">shutdown</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;shutdown method declaration
 </TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><clinit>, 
clone, 
equals, 
finalize, 
getClass, 
hashCode, 
notify, 
notifyAll, 
toString, 
wait, 
wait, 
wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="Cache(java.lang.String)"><!-- --></A><H3>
Cache</H3>
<PRE>
<B>Cache</B>(java.lang.String&nbsp;name)</PRE>
<DL>
<DD>Cache constructor declaration
 <P>The cache constructor sets up the initial parameters of the cache
 object, setting the name used for the file, etc.<DD><DL>
<DT><B>Parameters:</B><DD><CODE>name</CODE> - of database file</DL>
</DD>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="open(boolean)"><!-- --></A><H3>
open</H3>
<PRE>
void <B>open</B>(boolean&nbsp;readonly)
    throws java.sql.SQLException</PRE>
<DL>
<DD>open method declaration
 <P>The open method creates or opens a database file.<DD><DL>
<DT><B>Parameters:</B><DD><CODE>flag</CODE> - that indicates if this cache is readonly<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<HR>

<A NAME="flush()"><!-- --></A><H3>
flush</H3>
<PRE>
void <B>flush</B>()
     throws java.sql.SQLException</PRE>
<DL>
<DD>flush method declaration
 <P>The flush method saves all cached data to the file, saves the free position
 and closes the file.<DD><DL>
<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<HR>

<A NAME="shutdown()"><!-- --></A><H3>
shutdown</H3>
<PRE>
void <B>shutdown</B>()
        throws java.sql.SQLException</PRE>
<DL>
<DD>shutdown method declaration
 <P>the shutdown method closes the cache file.  It does not flush pending writes.<DD><DL>
<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<HR>

<A NAME="free(org.hsqldb.Row, int, int)"><!-- --></A><H3>
free</H3>
<PRE>
void <B>free</B>(<A HREF="../../org/hsqldb/Row.html">Row</A>&nbsp;r,
          int&nbsp;pos,
          int&nbsp;length)
    throws java.sql.SQLException</PRE>
<DL>
<DD>free method declaration
 <P>This method marks space in the database file as free.
 <P><B>Note: </B>If more than MAX_FREE_COUNT free positios then
 they are probably all are too small anyway; so we start a new list
 <P>todo: This is wrong when deleting lots of records<DD><DL>
<DT><B>Parameters:</B><DD><CODE>r</CODE> - (Row object to be marked free)<DD><CODE>pos</CODE> - (Offset in the file this Row was stored at)<DD><CODE>length</CODE> - (Size of the Row object to free)<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<HR>

<A NAME="add(org.hsqldb.Row)"><!-- --></A><H3>
add</H3>
<PRE>
void <B>add</B>(<A HREF="../../org/hsqldb/Row.html">Row</A>&nbsp;r)
   throws java.sql.SQLException</PRE>
<DL>
<DD>add method declaration
 <P>This method adds a Row to the Cache.  It walks the
 list of CacheFree objects to see if there is available space
 to store the new Row, reusing space if it exists, otherwise
 we grow the file.<DD><DL>
<DT><B>Parameters:</B><DD><CODE>r</CODE> - (Row to be added to Cache)<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<HR>

<A NAME="getRow(int, org.hsqldb.Table)"><!-- --></A><H3>
getRow</H3>
<PRE>
<A HREF="../../org/hsqldb/Row.html">Row</A> <B>getRow</B>(int&nbsp;pos,
           <A HREF="../../org/hsqldb/Table.html">Table</A>&nbsp;t)
     throws java.sql.SQLException</PRE>
<DL>
<DD>getRow method declaration
 <P>This method reads a Row object from the cache.<DD><DL>
<DT><B>Parameters:</B><DD><CODE>pos</CODE> - (offset of the requested Row in the cache)<DD><CODE>t</CODE> - (Table this Row belongs to)<DT><B>Returns:</B><DD>The Row Object as read from the cache.<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<HR>

<A NAME="cleanUp()"><!-- --></A><H3>
cleanUp</H3>
<PRE>
void <B>cleanUp</B>()
       throws java.sql.SQLException</PRE>
<DL>
<DD>cleanUp method declaration
 <P>This method cleans up the cache when it grows too large. It works by
 checking Rows in held in the Cache's iLastAccess member and removing
 Rows that haven't been accessed in the longest time.<DD><DL>
<DT><B>Throws:</B><DD>java.sql.SQLException - &nbsp;</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT ID="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT ID="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../deprecated-list.html"><FONT ID="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../org/hsqldb/ByteArray.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../org/hsqldb/CacheFree.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="Cache.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>

</BODY>
</HTML>
