<html xmlns:NetUtils="org.apache.cocoon.util.NetUtils">
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Parent Component Manager</title>
<script type="text/javascript" src="resources/script.js" language="JavaScript"></script>
</head>
<body bgcolor="#ffffff" marginheight="4" marginwidth="4" leftmargin="4" topmargin="4" alink="#cc0000" vlink="#0086b2" link="#039acc" text="#000000">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" rowspan="3" height="60" width="135"><img border="0" vspace="0" hspace="0" src="images/logo.gif" height="60" width="135"></td><td background="images/line.gif" colspan="2" align="left" valign="top" height="5" width="100%"><img align="left" border="0" vspace="0" hspace="0" src="images/line.gif" height="5" width="1"></td><td align="left" valign="top" rowspan="3" height="60" width="29"><img border="0" vspace="0" hspace="0" src="images/right.gif" height="60" width="29"></td>
</tr>
<tr>
<td bgcolor="#0086b2" colspan="2" align="right" valign="top" height="35" width="100%"><img align="right" alt="Parent Component Manager" border="0" vspace="0" hspace="0" src="graphics/parent-component-manager-header.jpg_label=Parent%20Component%20Manager.jpg"></td>
</tr>
<tr>
<td background="images/bottom.gif" bgcolor="#0086b2" align="left" valign="top" height="20" width="100%"><img align="left" border="0" vspace="0" hspace="0" src="images/bottom.gif" height="20" width="3"></td><td background="images/bottom.gif" width="288" valign="top" height="20" bgcolor="#0086b2" align="right">
<table width="288" cellspacing="0" cellpadding="0" border="0">
<tr>
<td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('xml');" onMouseOut="rolloverOff('xml');" target="new" href="http://xml.apache.org/"><img onLoad="rolloverLoad('xml', 'images/button-xml-hi.gif', 'images/button-xml-lo.gif');" border="0" vspace="0" hspace="0" name="xml" src="images/button-xml-lo.gif" height="20" width="96" alt="http://xml.apache.org/"></a></td><td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('asf');" onMouseOut="rolloverOff('asf');" target="new" href="http://www.apache.org/"><img onLoad="rolloverLoad('asf', 'images/button-asf-hi.gif', 'images/button-asf-lo.gif');" border="0" vspace="0" hspace="0" name="asf" src="images/button-asf-lo.gif" height="20" width="96" alt="http://www.apache.org/"></a></td><td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('w3c');" onMouseOut="rolloverOff('w3c');" target="new" href="http://www.w3.org/"><img onLoad="rolloverLoad('w3c', 'images/button-w3c-hi.gif', 'images/button-w3c-lo.gif');" border="0" vspace="0" hspace="0" name="w3c" src="images/button-w3c-lo.gif" height="20" width="96" alt="http://www.w3.org/"></a></td>
</tr>
</table>
</td>
</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr width="100%">
<td valign="top" width="120">
<table width="120" cellspacing="0" cellpadding="0" border="0">
<tr>
<td valign="top" align="left"><img width="120" vspace="0" src="images/join.gif" hspace="0" height="14" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Main')" onMouseOut="rolloverOff('Main')" href="../index.html"><img onLoad="rolloverLoad('Main', 'graphics/Main-label_over.jpg', 'graphics/Main-label.jpg');" vspace="0" hspace="0" name="Main" width="120" height="12" border="0" src="graphics/Main-label.jpg" alt="Main"></a></td>
</tr>
<tr>
<td valign="top" align="left"><img alt="Concepts" width="120" vspace="0" src="graphics/Concepts-separator.jpg" hspace="0" height="20" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Flow')" onMouseOut="rolloverOff('Flow')" href="httprequest.html"><img onLoad="rolloverLoad('Flow', 'graphics/Flow-label_over.jpg', 'graphics/Flow-label.jpg');" vspace="0" hspace="0" name="Flow" width="120" height="12" border="0" src="graphics/Flow-label.jpg" alt="Flow"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Extending C2')" onMouseOut="rolloverOff('Extending C2')" href="extending.html"><img onLoad="rolloverLoad('Extending C2', 'graphics/Extending%20C2-label_over.jpg', 'graphics/Extending%20C2-label.jpg');" vspace="0" hspace="0" name="Extending C2" width="120" height="12" border="0" src="graphics/Extending%20C2-label.jpg" alt="Extending C2"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Avalon')" onMouseOut="rolloverOff('Avalon')" href="avalon.html"><img onLoad="rolloverLoad('Avalon', 'graphics/Avalon-label_over.jpg', 'graphics/Avalon-label.jpg');" vspace="0" hspace="0" name="Avalon" width="120" height="12" border="0" src="graphics/Avalon-label.jpg" alt="Avalon"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Using Databases')" onMouseOut="rolloverOff('Using Databases')" href="datasources.html"><img onLoad="rolloverLoad('Using Databases', 'graphics/Using%20Databases-label_over.jpg', 'graphics/Using%20Databases-label.jpg');" vspace="0" hspace="0" name="Using Databases" width="120" height="12" border="0" src="graphics/Using%20Databases-label.jpg" alt="Using Databases"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Parent CM')" onMouseOut="rolloverOff('Parent CM')" href="parent-component-manager.html"><img onLoad="rolloverLoad('Parent CM', 'graphics/Parent%20CM-label_over.jpg', 'graphics/Parent%20CM-label.jpg');" vspace="0" hspace="0" name="Parent CM" width="120" height="12" border="0" src="graphics/Parent%20CM-label.jpg" alt="Parent CM"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Deli quick start')" onMouseOut="rolloverOff('Deli quick start')" href="deliquick.html"><img onLoad="rolloverLoad('Deli quick start', 'graphics/Deli%20quick%20start-label_over.jpg', 'graphics/Deli%20quick%20start-label.jpg');" vspace="0" hspace="0" name="Deli quick start" width="120" height="12" border="0" src="graphics/Deli%20quick%20start-label.jpg" alt="Deli quick start"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('CC/PP and UAProf')" onMouseOut="rolloverOff('CC/PP and UAProf')" href="deli.html"><img onLoad="rolloverLoad('CC/PP and UAProf', 'graphics/CC/PP%20and%20UAProf-label_over.jpg', 'graphics/CC/PP%20and%20UAProf-label.jpg');" vspace="0" hspace="0" name="CC/PP and UAProf" width="120" height="12" border="0" src="graphics/CC/PP%20and%20UAProf-label.jpg" alt="CC/PP and UAProf"></a></td>
</tr>
<tr>
<td valign="top" align="left"><img alt="Java" width="120" vspace="0" src="graphics/Java-separator.jpg" hspace="0" height="20" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('API (Javadoc)')" onMouseOut="rolloverOff('API (Javadoc)')" target="new" href="../apidocs/index.html"><img onLoad="rolloverLoad('API (Javadoc)', 'graphics/API%20(Javadoc)-label_over.jpg', 'graphics/API%20(Javadoc)-label.jpg');" width="120" vspace="0" name="API (Javadoc)" hspace="0" height="12" border="0" src="graphics/API%20(Javadoc)-label.jpg" alt="API (Javadoc)"></a></td>
</tr>
<tr>
<td align="left" valign="top"><img width="120" vspace="0" src="images/close.gif" hspace="0" height="14" border="0"><br>
</td>
</tr>
</table>
</td><td>
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td height="10" width="100%"></td>
</tr>
<tr>
<td>
        
        
            
<div align="right">
<table cellpadding="0" cellspacing="0" width="98%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif" size="+1"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Parent Component Manager</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="98%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
                
<p align="justify">When using Apache Cocoon it is sometimes neccessary to obtain
                    components from other sources than the <code><font face="courier, monospaced">user.roles</font></code> file,
                    or preferable to have a common component manager for several web applications.</p>
                
                
<p align="justify">The pattern chosen for Cocoon is the dynamic loading of a component manager class.
                    The initialization parameter parent-component-manager in web.xml specifies a class
                    that will be loaded, instantiated and used as a parent component manager for 
                    Cocoon's component manager.</p>
                
                
<p align="justify">The recommended procedure is for the class, when it is initialized, to create a 
                    delegate in the form of an <code><font face="courier, monospaced">ExcaliburComponentManager</font></code>, configure it
                    by looking up a <code><font face="courier, monospaced">Configuration</font></code> object via JNDI, and delegate any requests to it.</p>
                
                
<p align="justify">In order to provide a way to pass parameters to the parent component manager class 
                    (the class specified in parent-component-manager), Cocoon will instantiate the class
                    via the constructor that takes a single <code><font face="courier, monospaced">String</font></code> argument, passing
                    anything to the right of the first <code><font face="courier, monospaced">'/'</font></code> in the parameter value to the
                    constructor. Subsequently Cocoon examines whether the class implements 
                    <code><font face="courier, monospaced">org.apache.avalon.framework.logger.Loggable</font></code> and/or 
                    <code><font face="courier, monospaced">org.apache.avalon.framework.activity.Initializable</font></code> and calls
                    <code><font face="courier, monospaced">setLogger</font></code> and/or <code><font face="courier, monospaced">initialize</font></code>, as appropriate.
                    The instance is then used as a parent component manager.
                </p>
                                
                
<p align="justify">Since that didn't make much sense in itself, let's look at the sample.</p>
                
                
<p align="justify">The goal is to define a component that can give us the time of day and
                    let it be managed by a parent component manager.</p>
                
                
<p align="justify">So, first we need to put a Configuration object into JNDI, and then 
                    grab that object, use it to configure an ExcaliburComponentManager,
                    and pass on any requests to that manager.</p>
                
                
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Step 1: Creating a configuration object</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
                
                    
<p align="justify">We'll do this the quick and dirty way. The static initializer of a class
                        will create a Configuration instance with a single role and bind it
                        to <code><font face="courier, monospaced">org/apache/cocoon/samples/parentcm/ParentCMConfigration</font></code>.
                    </p>
                
                    
<p align="justify">The following code was taken from org/apache/cocoon/samples/parentcm/Configurator.java</p>
                    
                    
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
public class Configurator  {

    static {
        try {
            //
            // Create a new role.
            //
            DefaultConfiguration config = new DefaultConfiguration("roles", "");
            DefaultConfiguration timeComponent = new DefaultConfiguration("role", "roles");
            timeComponent.addAttribute("name", Time.ROLE);
            timeComponent.addAttribute("default-class", TimeComponent.class.getName());
            timeComponent.addAttribute("shorthand", "samples-parentcm-time");
            config.addChild(timeComponent);
            
            //
            // Bind it - get an initial context.
            //
            Hashtable environment = new Hashtable();
            environment.put(Context.INITIAL_CONTEXT_FACTORY, 
                            MemoryInitialContextFactory.class.getName());
            initialContext = new InitialContext(environment);
            
            //
            // Create subcontexts and bind the configuration.
            //
            Context ctx = initialContext.createSubcontext("org");
            ctx = ctx.createSubcontext("apache");
            ctx = ctx.createSubcontext("cocoon");
            ctx = ctx.createSubcontext("samples");
            ctx = ctx.createSubcontext("parentcm");
            ctx.rebind("ParentCMConfiguration", config);
        } catch (Exception e) {
            e.printStackTrace(System.err);
        }
    }    
}</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
                
                
<p align="justify">To make sure the static initializer runs we make Cocoon force-load the class
                    by making a change to the web.xml file:</p>
                
                
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
&lt;init-param&gt;
  &lt;param-name&gt;load-class&lt;/param-name&gt;
  &lt;param-value&gt;
    &lt;!-- For IBM WebSphere: 
    com.ibm.servlet.classloader.Handler --&gt;

    &lt;!-- For Database Driver: --&gt;
    org.hsqldb.jdbcDriver
        
    &lt;!-- For parent ComponentManager sample:
            This will cause the static initializer to run,
            and thus the Configuration object to be created
            and bound. --&gt;
    org.apache.cocoon.samples.parentcm.Configurator 
  &lt;/param-value&gt;
&lt;/init-param&gt;</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
                
</font></td>
</tr>
</table>
</div>
<br>
                
                
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Step 2: Write the component manager</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
                
                    
<p align="justify">Now that the configuration object is sitting there waiting for us, let's craft
                        the component manager. Please see the file org/apache/cocoon/samples/parentcm/ParentComponentManager.java
                        for an example. It is too much to paste in here.</p>
                
                
</font></td>
</tr>
</table>
</div>
<br>
                    
                
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Step 3: Tell Cocoon to use the component manager</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
                    
<p align="justify">Change the web.xml file to:</p>
                    
                    
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
&lt;init-param&gt;
  &lt;param-name&gt;parent-component-manager&lt;/param-name&gt;
  &lt;param-value&gt;org.apache.cocoon.samples.parentcm.ParentComponentManager/(remove this line break)
org/apache/cocoon/samples/parentcm/ParentCMConfiguration&lt;/param-value&gt;
&lt;/init-param&gt;</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
                    
                    
<p align="justify">Cocoon will now do the following: First, it will split the parameter value at the first slash,
                        in this case ending up with the strings <code><font face="courier, monospaced">"org.apache.cocoon.samples.parentcm.ParentComponentManager"</font></code>
                        and <code><font face="courier, monospaced">"org/apache/cocoon/samples/parentcm/ParentCMConfiguration"</font></code>. The first string is the 
                        class to instantiate. The second is the parameter that will be passed to the constructor.</p>
                    
                    
<p align="justify">Next, Cocoon loads the component manager class and uses reflection to find a constructor that
                        will accept a single <code><font face="courier, monospaced">String</font></code> argument. Upon finding one, it instantiates the
                        class in a manner similar to:</p>
                    
                    
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
ComponentManager cm = new 
    org.apache.cocoon.samples.parentcm.ParentComponentManager(
        "org/apache/cocoon/samples/parentcm/ParentCMConfiguration");</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
                    
                    
<p align="justify">
                        After this Cocoon checks whether the parent component manager class implements <code><font face="courier, monospaced">Initializable</font></code> and/or
                        <code><font face="courier, monospaced">Loggable</font></code>. Since the <code><font face="courier, monospaced">ParentComponentManager</font></code> class implements both, Cocoon
                        does the following (with simplification):
                    </p>
                    
                    
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
((Loggable) cm).setLogger(logger);
((Initializable) cm).initialize();</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
                    
                    
<p align="justify">Finally, the instance is used as parent component manager of Cocoon's own component manager.</p>
                
</font></td>
</tr>
</table>
</div>
<br>
                
                
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Step 4: Use the component</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
                
                    
<p align="justify">Cocoon components can now use the ComponentManager given to them by Cocoon to look up the
                        component managed by the parent component manager:</p>
                
                    
<p align="justify">The following code was taken from org/apache/cocoon/samples/parentcm/Generator.java</p>
                
                    
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
public void setup(SourceResolver resolver, Map objectModel, String src, Parameters par)
    throws ProcessingException, SAXException, IOException {
            
    Time timeGiver = null;
    try {
        timeGiver = (Time) manager.lookup(Time.ROLE);
        this.time = timeGiver.getTime ();
    } catch (ComponentException ce) {
        throw new ProcessingException ("Could not obtain current time.", ce);
    } finally {
        manager.release(timeGiver);
    }
}</pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
                
</font></td>
</tr>
</table>
</div>
<br>
                
                
<p align="justify">And that concludes the tour. A parent component manager was initialized with a configuration
                    obtained via JNDI and its components used by a Cocoon generator.</p>
            
</font></td>
</tr>
</table>
</div>
<br>
        
    
</td>
</tr>
</table>
</td>
</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td bgcolor="#0086b2"><img width="1" src="images/dot.gif" height="1"></td>
</tr>
<tr>
<td align="center"><font size="-1" face="arial,helvetica,sanserif" color="#0086b2"><i>Copyright &copy; 1999-2002 The Apache Software Foundation. All Rights Reserved.</i></font></td>
</tr>
</table>
</body>
</html>
