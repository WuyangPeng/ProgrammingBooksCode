<html xmlns:NetUtils="org.apache.cocoon.util.NetUtils">
<head>
<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Using Databases in Apache Cocoon</title>
<script type="text/javascript" src="resources/script.js" language="JavaScript"></script>
</head>
<body bgcolor="#ffffff" marginheight="4" marginwidth="4" leftmargin="4" topmargin="4" alink="#cc0000" vlink="#0086b2" link="#039acc" text="#000000">
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" rowspan="3" height="60" width="135"><img border="0" vspace="0" hspace="0" src="images/logo.gif" height="60" width="135"></td><td background="images/line.gif" colspan="2" align="left" valign="top" height="5" width="100%"><img align="left" border="0" vspace="0" hspace="0" src="images/line.gif" height="5" width="1"></td><td align="left" valign="top" rowspan="3" height="60" width="29"><img border="0" vspace="0" hspace="0" src="images/right.gif" height="60" width="29"></td>
</tr>
<tr>
<td bgcolor="#0086b2" colspan="2" align="right" valign="top" height="35" width="100%"><img align="right" alt="Using Databases in Apache Cocoon" border="0" vspace="0" hspace="0" src="graphics/datasources-header.jpg_label=Using%20Databases%20in%20Apache%20Cocoon.jpg"></td>
</tr>
<tr>
<td background="images/bottom.gif" bgcolor="#0086b2" align="left" valign="top" height="20" width="100%"><img align="left" border="0" vspace="0" hspace="0" src="images/bottom.gif" height="20" width="3"></td><td background="images/bottom.gif" width="288" valign="top" height="20" bgcolor="#0086b2" align="right">
<table width="288" cellspacing="0" cellpadding="0" border="0">
<tr>
<td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('xml');" onMouseOut="rolloverOff('xml');" target="new" href="http://xml.apache.org/"><img onLoad="rolloverLoad('xml', 'images/button-xml-hi.gif', 'images/button-xml-lo.gif');" border="0" vspace="0" hspace="0" name="xml" src="images/button-xml-lo.gif" height="20" width="96" alt="http://xml.apache.org/"></a></td><td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('asf');" onMouseOut="rolloverOff('asf');" target="new" href="http://www.apache.org/"><img onLoad="rolloverLoad('asf', 'images/button-asf-hi.gif', 'images/button-asf-lo.gif');" border="0" vspace="0" hspace="0" name="asf" src="images/button-asf-lo.gif" height="20" width="96" alt="http://www.apache.org/"></a></td><td align="left" valign="top" height="20" width="96"><a onMouseOver="rolloverOn('w3c');" onMouseOut="rolloverOff('w3c');" target="new" href="http://www.w3.org/"><img onLoad="rolloverLoad('w3c', 'images/button-w3c-hi.gif', 'images/button-w3c-lo.gif');" border="0" vspace="0" hspace="0" name="w3c" src="images/button-w3c-lo.gif" height="20" width="96" alt="http://www.w3.org/"></a></td>
</tr>
</table>
</td>
</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr width="100%">
<td valign="top" width="120">
<table width="120" cellspacing="0" cellpadding="0" border="0">
<tr>
<td valign="top" align="left"><img width="120" vspace="0" src="images/join.gif" hspace="0" height="14" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Main')" onMouseOut="rolloverOff('Main')" href="../index.html"><img onLoad="rolloverLoad('Main', 'graphics/Main-label_over.jpg', 'graphics/Main-label.jpg');" vspace="0" hspace="0" name="Main" width="120" height="12" border="0" src="graphics/Main-label.jpg" alt="Main"></a></td>
</tr>
<tr>
<td valign="top" align="left"><img alt="Concepts" width="120" vspace="0" src="graphics/Concepts-separator.jpg" hspace="0" height="20" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Flow')" onMouseOut="rolloverOff('Flow')" href="httprequest.html"><img onLoad="rolloverLoad('Flow', 'graphics/Flow-label_over.jpg', 'graphics/Flow-label.jpg');" vspace="0" hspace="0" name="Flow" width="120" height="12" border="0" src="graphics/Flow-label.jpg" alt="Flow"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Extending C2')" onMouseOut="rolloverOff('Extending C2')" href="extending.html"><img onLoad="rolloverLoad('Extending C2', 'graphics/Extending%20C2-label_over.jpg', 'graphics/Extending%20C2-label.jpg');" vspace="0" hspace="0" name="Extending C2" width="120" height="12" border="0" src="graphics/Extending%20C2-label.jpg" alt="Extending C2"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Avalon')" onMouseOut="rolloverOff('Avalon')" href="avalon.html"><img onLoad="rolloverLoad('Avalon', 'graphics/Avalon-label_over.jpg', 'graphics/Avalon-label.jpg');" vspace="0" hspace="0" name="Avalon" width="120" height="12" border="0" src="graphics/Avalon-label.jpg" alt="Avalon"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Using Databases')" onMouseOut="rolloverOff('Using Databases')" href="datasources.html"><img onLoad="rolloverLoad('Using Databases', 'graphics/Using%20Databases-label_over.jpg', 'graphics/Using%20Databases-label.jpg');" vspace="0" hspace="0" name="Using Databases" width="120" height="12" border="0" src="graphics/Using%20Databases-label.jpg" alt="Using Databases"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Parent CM')" onMouseOut="rolloverOff('Parent CM')" href="parent-component-manager.html"><img onLoad="rolloverLoad('Parent CM', 'graphics/Parent%20CM-label_over.jpg', 'graphics/Parent%20CM-label.jpg');" vspace="0" hspace="0" name="Parent CM" width="120" height="12" border="0" src="graphics/Parent%20CM-label.jpg" alt="Parent CM"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('Deli quick start')" onMouseOut="rolloverOff('Deli quick start')" href="deliquick.html"><img onLoad="rolloverLoad('Deli quick start', 'graphics/Deli%20quick%20start-label_over.jpg', 'graphics/Deli%20quick%20start-label.jpg');" vspace="0" hspace="0" name="Deli quick start" width="120" height="12" border="0" src="graphics/Deli%20quick%20start-label.jpg" alt="Deli quick start"></a></td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('CC/PP and UAProf')" onMouseOut="rolloverOff('CC/PP and UAProf')" href="deli.html"><img onLoad="rolloverLoad('CC/PP and UAProf', 'graphics/CC/PP%20and%20UAProf-label_over.jpg', 'graphics/CC/PP%20and%20UAProf-label.jpg');" vspace="0" hspace="0" name="CC/PP and UAProf" width="120" height="12" border="0" src="graphics/CC/PP%20and%20UAProf-label.jpg" alt="CC/PP and UAProf"></a></td>
</tr>
<tr>
<td valign="top" align="left"><img alt="Java" width="120" vspace="0" src="graphics/Java-separator.jpg" hspace="0" height="20" border="0"><br>
</td>
</tr>
<tr>
<td valign="top" align="left"><a onMouseOver="rolloverOn('API (Javadoc)')" onMouseOut="rolloverOff('API (Javadoc)')" target="new" href="../apidocs/index.html"><img onLoad="rolloverLoad('API (Javadoc)', 'graphics/API%20(Javadoc)-label_over.jpg', 'graphics/API%20(Javadoc)-label.jpg');" width="120" vspace="0" name="API (Javadoc)" hspace="0" height="12" border="0" src="graphics/API%20(Javadoc)-label.jpg" alt="API (Javadoc)"></a></td>
</tr>
<tr>
<td align="left" valign="top"><img width="120" vspace="0" src="images/close.gif" hspace="0" height="14" border="0"><br>
</td>
</tr>
</table>
</td><td>
<table cellspacing="0" cellpadding="0" border="0">
<tr>
<td height="10" width="100%"></td>
</tr>
<tr>
<td> 
   
   
   
<div align="right">
<table cellpadding="0" cellspacing="0" width="98%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif" size="+1"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>How do I choose my database?</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="98%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif"> 
    
<p align="justify">
     Apache Cocoon is flexible in the way it allows you to make connections to
     a database.  There are basically two ways: by redefining all the connection
     parameters in each page you use a database, or using a pooled connection.
     The first method is slow and doesn't scale well.  The second method is more
     scalable, and depending on your database will realize true improvements.
    </p>
    
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Installing the Driver</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
     
<p align="justify">
       Independent of how you choose to get and maintain your JDBC connections,
       you have to load the driver so Cocoon can use it (unless you are using
       a J2EE container--more on that later).  This is an init parameter in
       your web.xml file.  The following snippet will show you how:
     </p>
     
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
      
&lt;init-param&gt;
  &lt;param-name&gt;load-class&lt;/param-name&gt;
  &lt;param-value&gt;
    &lt;!-- For PostgeSQL Database: --&gt;
    postgresql.Driver

    &lt;!-- For Oracle Database: --&gt;
    oracle.jdbc.driver.OracleDriver
  &lt;/param-value&gt;
&lt;/init-param&gt;
      
     </pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
     
<p align="justify">
      You can place as many Driver classes in this parameter you want.  They
      are separated by white space or commas.
     </p>
    
</font></td>
</tr>
</table>
</div>
<br>
    
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Defining a Data Source</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
     
<p align="justify">
      Cocoon allows you to specify a pooled data source that you can use
      for throughout the Cocoon system.  There are two different types of
      data sources: JDBC and J2EE.  The difference is in who controls the
      connection.  The JDBC data source lets Cocoon handle all the pooling
      logic.  The J2EE data source tells Cocoon how to pull the DataSource
      object from a J2EE container (thats Java 2 Enterprise Edition)--the
      major caveat is that Cocoon must be installed as part of a Enterprise
      Application.
     </p>
     
<p align="justify">
      The following snippet of cocoon.xconf shows the section where the
      DataSourceComponent is specified.  You can have more than one in
      this location.  The code will have one connection for the JDBC data
      source, and one connection for the J2EE data source.
     </p>
     
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
      
  &lt;datasources&gt;
    &lt;jdbc name="MyConnectionName"&gt;

      &lt;pool-controller min="5" max="10"/&gt;
      &lt;dburl&gt;jdbc:oracle:thin:@localhost:1521:mydatabase&lt;/dburl&gt;
      &lt;user&gt;mylogin&lt;/user&gt;
      &lt;password&gt;myPassword&lt;/password&gt;
    &lt;/jdbc&gt;
    &lt;j2ee name="MyJ2eeConnection"&gt;
      &lt;dbname&gt;cocoonDB&lt;/dbname&gt;
    &lt;/j2ee&gt;
  &lt;/datasources&gt;
      
     </pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>

     
<div align="right">
<table cellpadding="0" cellspacing="0" width="90%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif" size="-1"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>The JDBC Connection Properties</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="90%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
      
<p align="justify">
       The JDBC connection has up to five different properties--but only one
       is absolutely required.
      </p>
      
<blockquote>
<ul>
       
<li>
         dburl: This is absolutely required.  Without it JDBC can't connect
	 to the database.
       </li>
       
<li>
         user: This is only required if the database admin requires you to
	 log in to the database.
       </li>
       
<li>
         password: This is only required if the database admin requires a
	 password to connect to the database.
       </li>
       
<li>
         pool-controller: This has two parameters with defaults.  If it is
	 not specified, the defaults are used.
	 <blockquote>
<ul>
	   
<li>
	     min: The minimum number of connections the pool will keep
	     available at one time.  Defaults to zero (0).
	   </li>
	   
<li>
	     max: The maximum number of connections the pool will have
	     created at the same time.  Defaults to three (3).
	   </li>
         
<li>
           oradb: If you have an Oracle database, you should add the attribute
                  "oradb" and set it to true.
         </li>
	 
</ul>
</blockquote>
       
</li>
       
<li>
        auto-commit: If you need to ensure an autocommit is set to true or
                     false, then create the "auto-commit" element.
       </li>
      
</ul>
</blockquote>
     
</font></td>
</tr>
</table>
</div>
<br>
     
<div align="right">
<table cellpadding="0" cellspacing="0" width="90%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif" size="-1"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>The J2EE Connection Property</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="90%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
      
<p align="justify">
        The J2EE connection has only one property and it is absolutely
	required.  Cocoon uses JNDI to look up the DataSource with the
	name you specified in "dbname".
      </p>
     
</font></td>
</tr>
</table>
</div>
<br>
    
</font></td>
</tr>
</table>
</div>
<br>
    
<div align="right">
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td align="right" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-left.gif"></td><td background="images/bar-border-top.gif"><img border="0" hspace="0" vspace="0" height="5" width="1" src="images/void.gif"></td><td align="left" valign="bottom" height="7" width="9"><img border="0" hspace="0" vspace="0" height="7" width="9" src="images/bar-top-right.gif"></td>
</tr>
<tr>
<td background="images/bar-border-left.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td><td bgcolor="#0086b2" width="100%"><font color="#ffffff" face="arial,helvetica,sanserif"><img border="0" hspace="0" vspace="0" height="5" width="5" src="images/void.gif"><b>Using the Data Source Component</b></font></td><td background="images/bar-border-right.gif" width="9"><img border="0" hspace="0" vspace="0" height="1" width="9" src="images/void.gif"></td>
</tr>
<tr>
<td align="right" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-left.gif"></td><td background="images/bar-border-bottom.gif"><img border="0" hspace="0" vspace="0" height="12" width="1" src="images/void.gif"></td><td align="left" valign="top" height="12" width="9"><img border="0" hspace="0" vspace="0" height="12" width="9" src="images/bar-bottom-right.gif"></td>
</tr>
</table>
<table cellpadding="0" cellspacing="0" width="95%" border="0">
<tr>
<td><font color="#000000" face="arial,helvetica,sanserif">
      
<p align="justify">
       No matter how you defined your DataSourceComponent, you access
       it the same way.  Because The DataSourceComponent is a Component,
       your class needs to implement the Avalon Composer interface.  The
       Avalon Framework will give your class a ComponentManager.  At that
       point, it is up to you how and when you pull the DataSourceComponent
       out of the ComponentManager.
      </p>
      
<div align="center">
<table border="0" cellpadding="0" cellspacing="4">
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td bgcolor="#ffffff">
<pre>
       
import org.apache.avalon.framework.component.ComponentManager;
import org.apache.avalon.framework.component.ComponentSelector;
import org.apache.cocoon.Roles;
import org.apache.avalon.excalibur.datasource.DataSourceComponent;

import java.sql.Connection;

// .... Skip a lot of lines until we are in the method you use
//      to initialize the DataSourceComponent ....

private DataSourceComponent datasource;

public void compose(ComponentManager manager) {
    ComponentSelector selector =
        (ComponentSelector) manager.lookup(Roles.DB_CONNECTION);
    this.datasource = (DataSourceComponent) selector.select("MyConnectionName");
}

// .... Skip more lines until we actually need to use the datasource

private void meMethod() {
    Connection myConnection = this.datasource.getConnection();

    // .... perform SQL code here

    myConnection.close();
}
       
      </pre>
</td><td width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
<tr>
<td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td><td height="1" width="1" bgcolor="#0086b2"><img border="0" hspace="0" vspace="0" height="1" width="1" src="images/void.gif"></td>
</tr>
</table>
</div>
      
<p align="justify">
       Notice that once you obtained your connection, you did nothing out of the
       ordinary to return the connection to the pool?  This is by design, and a
       result of the JDBC specification.  Basically the JDBC specification states
       that if a driver implements pooled connections, then it should not alter
       the way those connections are used.  This maintains the portability of
       your code.
      </p>
    
</font></td>
</tr>
</table>
</div>
<br>
   
</font></td>
</tr>
</table>
</div>
<br> 
  

</td>
</tr>
</table>
</td>
</tr>
</table>
<table width="100%" cellspacing="0" cellpadding="0" border="0">
<tr>
<td bgcolor="#0086b2"><img width="1" src="images/dot.gif" height="1"></td>
</tr>
<tr>
<td align="center"><font size="-1" face="arial,helvetica,sanserif" color="#0086b2"><i>Copyright &copy; 1999-2002 The Apache Software Foundation. All Rights Reserved.</i></font></td>
</tr>
</table>
</body>
</html>
